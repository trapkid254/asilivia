<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - Aslivia Tech</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/products.css">
    <link rel="stylesheet" href="../styles/product-detail.css">
</head>

<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <a href="../index.html" class="logo">Aslivia<span>Tech</span></a>
            
            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav>
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="services.html">Repair Services</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="booking.html">Booking</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                </ul>
            </nav>
            
            <div class="header-actions">
                <a href="login.html"><i class="fas fa-user"></i></a>
                <a href="cart.html" class="cart-icon">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count">0</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Product Detail Section -->
    <section class="product-detail-page">
        <div class="container">
            <div class="breadcrumb">
                <a href="../index.html">Home</a> > 
                <a href="products.html">Products</a> > 
                <span id="breadcrumbProductName">Product</span>
            </div>
            
            <div class="product-detail-container">
                <div class="product-gallery">
                    <div class="main-image">
                        <img src="../assets/images/placeholder-smartphone.jpg" alt="Product Image" id="mainProductImage" onerror="this.src='https://via.placeholder.com/500x500?text=Product+Image'">
                    </div>
                    <div class="thumbnail-images">
                        <div class="thumbnail active">
                            <img src="../assets/images/placeholder-smartphone.jpg" alt="Thumbnail 1" onerror="this.src='https://via.placeholder.com/100x100?text=Thumb+1'">
                        </div>
                        <div class="thumbnail">
                            <img src="../assets/images/placeholder-smartphone-2.jpg" alt="Thumbnail 2" onerror="this.src='https://via.placeholder.com/100x100?text=Thumb+2'">
                        </div>
                        <div class="thumbnail">
                            <img src="../assets/images/placeholder-smartphone-3.jpg" alt="Thumbnail 3" onerror="this.src='https://via.placeholder.com/100x100?text=Thumb+3'">
                        </div>
                    </div>
                </div>
                
                <div class="product-info">
                    <h1 id="productTitle">Product</h1>
                    <div class="product-rating">
                        <div class="stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                        </div>
                        <span class="rating-value">4.5 (128 reviews)</span>
                    </div>
                    
                    <div class="product-price">
                        <span class="current-price" id="productPrice">KSh 0.00</span>
                    </div>
                    
                    <div class="product-description">
                        <p id="productDescription">Product description will appear here.</p>
                    </div>
                    
                    <div class="product-options">
                        <div class="option-group">
                            <label>Color:</label>
                            <div class="color-options">
                                <div class="color-option active" data-color="midnight" style="background-color: #1a1a1a;"></div>
                                <div class="color-option" data-color="starlight" style="background-color: #faf7f2;"></div>
                                <div class="color-option" data-color="blue" style="background-color: #215e7e;"></div>
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label for="storage">Storage:</label>
                            <select id="storage">
                                <option value="128gb">128GB</option>
                                <option value="256gb">256GB (+KSh 100)</option>
                                <option value="512gb">512GB (+KSh 200)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="product-actions">
                        <div class="quantity-selector">
                            <label for="quantity">Quantity:</label>
                            <div class="quantity-controls">
                                <button class="qty-btn minus">-</button>
                                <input type="number" id="quantity" value="1" min="1">
                                <button class="qty-btn plus">+</button>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-accent add-to-cart-btn" id="addToCartBtn">
                                <i class="fas fa-shopping-cart"></i> Add to Cart
                            </button>
                            <button class="btn buy-now-btn">Buy Now</button>
                        </div>
                    </div>
                    
                    <div class="product-meta" id="productMeta">
                        <div class="meta-item">
                            <i class="fas fa-truck"></i>
                            <span>Delivery available countrywide</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-undo"></i>
                            <span>30-day return policy</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>1-year warranty</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="product-details-tabs">
                <div class="tabs-header">
                    <button class="tab-link active" data-tab="description">Description</button>
                    <button class="tab-link" data-tab="specifications">Specifications</button>
                    <button class="tab-link" data-tab="reviews">Reviews</button>
                </div>
                
                <div class="tabs-content">
                    <div id="description" class="tab-content active">
                        <h3>Product Description</h3>
                        <p>The Premium Smartphone XYZ is designed to provide an exceptional user experience with its cutting-edge technology and sleek design. Whether you're capturing stunning photos, playing graphics-intensive games, or staying productive on the go, this smartphone delivers outstanding performance.</p>
                        
                        <h4>Key Features:</h4>
                        <ul>
                            <li>6.7-inch Super Retina XDR display with ProMotion technology</li>
                            <li>A15 Bionic chip with 6-core CPU and 5-core GPU</li>
                            <li>Advanced dual-camera system with 12MP Wide and Ultra Wide cameras</li>
                            <li>12MP TrueDepth front camera with Night mode</li>
                            <li>5G connectivity for faster downloads and streaming</li>
                            <li>All-day battery life with up to 28 hours of video playback</li>
                            <li>Ceramic Shield front cover for superior durability</li>
                            <li>iOS operating system with regular security updates</li>
                        </ul>
                    </div>
                    
                    <div id="specifications" class="tab-content">
                        <h3>Technical Specifications</h3>
                        <table class="specs-table">
                            <tr>
                                <th>Display</th>
                                <td>6.7-inch Super Retina XDR display, 2778 x 1284 pixels</td>
                            </tr>
                            <tr>
                                <th>Chip</th>
                                <td>A15 Bionic chip with 6-core CPU, 5-core GPU, and 16-core Neural Engine</td>
                            </tr>
                            <tr>
                                <th>Camera</th>
                                <td>Dual 12MP camera system ( Wide and Ultra Wide), Night mode, Deep Fusion, Smart HDR 4</td>
                            </tr>
                            <tr>
                                <th>Front Camera</th>
                                <td>12MP TrueDepth camera with Night mode and Deep Fusion</td>
                            </tr>
                            <tr>
                                <th>Video Recording</th>
                                <td>4K video recording at 24 fps, 25 fps, 30 fps, or 60 fps</td>
                            </tr>
                            <tr>
                                <th>Battery</th>
                                <td>Built-in rechargeable lithium-ion battery, Up to 28 hours video playback</td>
                            </tr>
                            <tr>
                                <th>Connectivity</th>
                                <td>5G, Wi-Fi 6, Bluetooth 5.0, NFC with reader mode</td>
                            </tr>
                            <tr>
                                <th>Water Resistance</th>
                                <td>IP68 rating (maximum depth of 6 meters up to 30 minutes)</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div id="reviews" class="tab-content">
                        <h3>Customer Reviews</h3>
                        <div class="review-summary">
                            <div class="overall-rating">
                                <div class="rating-value">4.5</div>
                                <div class="stars">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star-half-alt"></i>
                                </div>
                                <div class="total-reviews">Based on 128 reviews</div>
                            </div>
                            
                            <div class="rating-bars">
                                <div class="rating-bar">
                                    <span>5 stars</span>
                                    <div class="bar">
                                        <div class="fill" style="width: 70%;"></div>
                                    </div>
                                    <span>70%</span>
                                </div>
                                <div class="rating-bar">
                                    <span>4 stars</span>
                                    <div class="bar">
                                        <div class="fill" style="width: 20%;"></div>
                                    </div>
                                    <span>20%</span>
                                </div>
                                <div class="rating-bar">
                                    <span>3 stars</span>
                                    <div class="bar">
                                        <div class="fill" style="width: 7%;"></div>
                                    </div>
                                    <span>7%</span>
                                </div>
                                <div class="rating-bar">
                                    <span>2 stars</span>
                                    <div class="bar">
                                        <div class="fill" style="width: 2%;"></div>
                                    </div>
                                    <span>2%</span>
                                </div>
                                <div class="rating-bar">
                                    <span>1 star</span>
                                    <div class="bar">
                                        <div class="fill" style="width: 1%;"></div>
                                    </div>
                                    <span>1%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="reviews-list">
                            <div class="review">
                                <div class="review-header">
                                    <div class="reviewer">John D.</div>
                                    <div class="review-date">October 15, 2023</div>
                                    <div class="review-rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                </div>
                                <div class="review-title">Excellent phone!</div>
                                <div class="review-content">
                                    <p>This is by far the best phone I've ever owned. The camera quality is exceptional, battery life lasts all day, and the performance is smooth. Highly recommend!</p>
                                </div>
                            </div>
                            
                            <div class="review">
                                <div class="review-header">
                                    <div class="reviewer">Sarah M.</div>
                                    <div class="review-date">October 12, 2023</div>
                                    <div class="review-rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                    </div>
                                </div>
                                <div class="review-title">Great but expensive</div>
                                <div class="review-content">
                                    <p>The phone is amazing in terms of features and performance. The only downside is the price, but you get what you pay for. The display is stunning and the cameras are professional quality.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="related-products">
                <h2>You May Also Like</h2>
                <div class="product-grid">
                    <div class="product-card">
                        <div class="product-img">
                            <img src="../assets/images/placeholder-laptop.jpg" alt="Laptop" onerror="this.src='https://via.placeholder.com/250x200?text=Laptop'">
                        </div>
                        <div class="product-content">
                            <h3 class="product-title">Ultrabook Pro 2023</h3>
                            <div class="product-price">KSh 1299.99</div>
                            <div class="product-actions">
                                <a href="product-detail.html" class="btn">Details</a>
                                <a href="#" class="btn btn-accent btn-add-to-cart">Add to Cart</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="product-card">
                        <div class="product-img">
                            <img src="../assets/images/placeholder-headphones.jpg" alt="Headphones" onerror="this.src='https://via.placeholder.com/250x200?text=Headphones'">
                        </div>
                        <div class="product-content">
                            <h3 class="product-title">Wireless Noise-Cancelling Headphones</h3>
                            <div class="product-price">KSh 249.99</div>
                            <div class="product-actions">
                                <a href="product-detail.html" class="btn">Details</a>
                                <a href="#" class="btn btn-accent btn-add-to-cart">Add to Cart</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="product-card">
                        <div class="product-img">
                            <img src="../assets/images/placeholder-smartwatch.jpg" alt="Smartwatch" onerror="this.src='https://via.placeholder.com/250x200?text=Smartwatch'">
                        </div>
                        <div class="product-content">
                            <h3 class="product-title">Smart Fitness Tracker</h3>
                            <div class="product-price">KSh 199.99</div>
                            <div class="product-actions">
                                <a href="product-detail.html" class="btn">Details</a>
                                <a href="#" class="btn btn-accent btn-add-to-cart">Add to Cart</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-column">
                    <h3>Aslivia Tech</h3>
                    <p>Your one-stop solution for all electronics shopping and repair needs.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com/peninsilvana.mepoclares" target="_blank" rel="noopener"><i class="fab fa-facebook"></i></a>
                        <a href="https://www.tiktok.com/@aslivia373?_r=1&_d=ed20kmgjef793k&sec_uid=MS4wLjABAAAAAKnX6AWPtQJqJdzMxI7VVyGLsrmboLLlOxGMlrrpt3aEDT1K4p4mpgIFNTnY7bIw&share_author_id=7024913671055344646&sharer_language=en&source=h5_m&u_code=dlcj759bg8hf1a&timestamp=1758565347&user_id=7024913671055344646&sec_user_id=MS4wLjABAAAAAKnX6AWPtQJqJdzMxI7VVyGLsrmboLLlOxGMlrrpt3aEDT1K4p4mpgIFNTnY7bIw&item_author_type=1&utm_source=whatsapp&utm_campaign=client_share&utm_medium=android&share_iid=7551446116957652748&share_link_id=538aaf9f-2182-451e-811a-23c42821f226&share_app_id=1233&ugbiz_name=ACCOUNT&ug_btm=b8727%2Cb7360&social_share_type=5&enable_checksum=1" target="_blank" rel="noopener"><i class="fab fa-tiktok"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Shop</h3>
                    <ul>
                        <li><a href="products.html?category=mobiles">Mobile Phones</a></li>
                        <li><a href="products.html?category=laptops">Laptops</a></li>
                        <li><a href="products.html?category=accessories">Accessories</a></li>
                        <li><a href="products.html?category=refurbished">Refurbished Devices</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Services</h3>
                    <ul>
                        <li><a href="services.html">Phone Repair</a></li>
                        <li><a href="services.html">Laptop Repair</a></li>
                        <li><a href="services.html">Other Device Repair</a></li>
                        <li><a href="booking.html">Book a Repair</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> Narok Town, Narok</li>
                        <li><i class="fas fa-phone"></i> +254 799 220 210</li>
                        <li><i class="fas fa-envelope"></i> pmepoclares@gmail.com</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Aslivia Tech. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../scripts/data-manager.js"></script>
    <script src="../scripts/main.js"></script>
    <script src="../scripts/api.js"></script>
    <script>
    (function(){
        function qs(name){
            const p=new URLSearchParams(window.location.search);return p.get(name);
        }
        function formatPrice(ksh){
            const n = Number(ksh||0);return 'KSh ' + n.toFixed(2);
        }
        function renderProduct(p){
            if(!p) return;
            const titleEl = document.getElementById('productTitle');
            const imgEl = document.getElementById('mainProductImage');
            const priceEl = document.getElementById('productPrice');
            const descEl = document.getElementById('productDescription');
            const breadcrumbEl = document.getElementById('breadcrumbProductName');
            const metaEl = document.getElementById('productMeta');
            const addBtn = document.getElementById('addToCartBtn');

            if(titleEl) titleEl.textContent = p.name || 'Product';
            if(breadcrumbEl) breadcrumbEl.textContent = p.name || 'Product';
            if(imgEl) imgEl.src = p.image || '../assets/images/placeholder-smartphone.jpg';
            if(priceEl) priceEl.textContent = formatPrice(p.price);
            if(descEl) descEl.textContent = p.description || '';

            // Stock badge
            const stock = Number(p.stock)||0;
            const stockItem = document.createElement('div');
            stockItem.className = 'meta-item';
            stockItem.innerHTML = `<i class="fas fa-box"></i><span>Stock: ${stock}</span>`;
            if(metaEl) metaEl.prepend(stockItem);

            // Wire add to cart button
            if(addBtn){
                addBtn.dataset.id = p.id;
                if (stock <= 0){
                    addBtn.classList.add('disabled');
                    addBtn.setAttribute('aria-disabled','true');
                    addBtn.textContent = 'Out of Stock';
                }
                addBtn.addEventListener('click', function(e){
                    e.preventDefault();
                    if (stock <= 0) return;
                    // Expect initializeCart/addToCart helpers in main.js
                    if (typeof window.addToCart === 'function') {
                        window.addToCart({ id: p.id, name: p.name, price: p.price, image: p.image, qty: 1 });
                    } else {
                        // Fallback simple cart in localStorage
                        try {
                            const raw = localStorage.getItem('cart');
                            const items = raw ? JSON.parse(raw) : [];
                            const idx = items.findIndex(it=>it.id===p.id);
                            if(idx>-1){ items[idx].qty = (parseInt(items[idx].qty)||0)+1; }
                            else { items.push({ id:p.id, name:p.name, price:p.price, image:p.image, qty:1 }); }
                            localStorage.setItem('cart', JSON.stringify(items));
                            localStorage.setItem('cartCount', String(items.reduce((s,it)=>s+(parseInt(it.qty)||0),0)));
                            const cc=document.querySelector('.cart-count'); if(cc) cc.textContent=localStorage.getItem('cartCount')||'0';
                            alert('Added to cart');
                        } catch(_) {}
                    }
                });
            }
        }

        async function init(){
            const id = qs('id');
            if (!id){ return; }
            // Try backend first
            let product = null;
            if (window.api && typeof window.api.getJSON === 'function'){
                try {
                    const fetched = await window.api.getJSON('/api/products/' + encodeURIComponent(id));
                    if (fetched && fetched._id){
                        product = {
                            id: fetched._id,
                            name: fetched.name,
                            price: Number(fetched.price)||0,
                            category: fetched.category||'',
                            brand: fetched.brand||'',
                            image: fetched.image||'../assets/images/placeholder-smartphone.jpg',
                            description: fetched.description||'',
                            stock: Number(fetched.stock)||0,
                            status: fetched.status||'active',
                        };
                    }
                } catch(_) { /* fallback below */ }
            }
            if (!product && window.dataManager){
                product = (window.dataManager.getProducts()||[]).find(p=>p.id===id);
            }
            renderProduct(product);
        }

        window.addEventListener('load', init);
    })();
    </script>
</body>
</html>